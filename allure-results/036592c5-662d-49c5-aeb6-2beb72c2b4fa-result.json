{"name": "test_specific_feature", "status": "broken", "statusDetails": {"message": "UnboundLocalError: cannot access local variable 'handle_response' where it is not associated with a value", "trace": "@pytest.mark.asyncio\n    async def test_specific_feature():\n        playwright, browser, context = await setup_browser()  # 使用默认设备iPhone 11\n        test_failed = False\n        fail_message = \"\"\n        try:\n            page = await load_and_check_page(context)\n            print(\"Page loaded successfully.\")\n    \n            await login(page, \"all24042501\", \"396012\")  # 使用公共登录函数\n    \n            with step(\"导航到个人中心\"):\n                await page.click(\"div.label:has-text('個人中心')\")\n                await asyncio.sleep(2)\n                await take_screenshot_and_attach(page, \"after_navigate_to_personal_center\")\n    \n            with step(\"点击存款\"):\n                await page.click(\"div.label:has-text('存款')\")\n                await asyncio.sleep(2)\n                await take_screenshot_and_attach(page, \"after_click_deposit\")\n    \n            with step(\"选择数字乐\"):\n                await page.click(\"div.am-list-content:has-text('數字樂')\")\n                await asyncio.sleep(2)\n                await take_screenshot_and_attach(page, \"after_select_bank_transfer\")\n    \n            with step(\"输入充值金额\"):\n                await page.fill(\"input#chargeAmount.fc-red\", \"100\")\n                await asyncio.sleep(2)\n                await take_screenshot_and_attach(page, \"after_enter_deposit_amount\")\n    \n            async def handle_response(response):\n                if response.url == \"https://wap-q6.qbpink01.com/payment/frontend/doPay\":\n                    json_data = await response.json()\n                    print(f\"Response from doPay: {json_data}\")\n                    if json_data.get('code') == '2313':\n                        nonlocal test_failed, fail_message\n                        test_failed = True\n                        fail_message = f\"Test failed with message: {\n                            json_data.get('msg')}\"\n    \n            page.on('response', handle_response)\n    \n            with step(\"点击下一步按钮\"):\n                await page.click(\"a.submitBtn:has-text('下一步')\")\n                await asyncio.sleep(2)\n                await take_screenshot_and_attach(page, \"after_confirm_deposit\")\n    \n            with step(\"确认充值完成\"):\n                await page.click(\"a:has-text('已完成充值')\")\n                await asyncio.sleep(2)\n                await take_screenshot_and_attach(page, \"after_confirm_deposit\")\n    \n        except Exception as e:\n            print(f\"An error occurred: {e}\")\n            if page is not None:\n                await take_screenshot_and_attach(page, \"error_during_test\")\n        finally:\n            # 注销监听器\n>           page.remove_listener('response', handle_response)\nE           UnboundLocalError: cannot access local variable 'handle_response' where it is not associated with a value\n\nbasic_module\\test_digital music.py:66: UnboundLocalError"}, "attachments": [{"name": "stdout", "source": "256381ad-287a-47e8-9694-3e77537d021f-attachment.txt", "type": "text/plain"}], "start": 1716866091452, "stop": 1716866092495, "uuid": "b3000a08-8e10-4eae-a766-636618f2b1ae", "historyId": "25d87ba0cfa6d2772725fc948070e326", "testCaseId": "25d87ba0cfa6d2772725fc948070e326", "fullName": "basic_module.test_digital music#test_specific_feature", "labels": [{"name": "tag", "value": "asyncio"}, {"name": "parentSuite", "value": "basic_module"}, {"name": "suite", "value": "test_digital music"}, {"name": "host", "value": "Luke"}, {"name": "thread", "value": "22136-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "basic_module.test_digital music"}]}